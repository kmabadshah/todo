{"version":3,"sources":["webpack:///./src/pages/login.js"],"names":["Login","token","allUsers","setCurrentUser","x","setX","React","useContext","Context","loading","setLoading","useState","setError","getValues","register","handleSubmit","watch","errors","clearErrors","useForm","id","className","onSubmit","async","user","checkLoginData","data","rem_me","cacheToLocalStorage","jwtSecret","navigate","type","message","err_msgs","placeholder","name","onChange","ref","required","as","to","disabled","isEmpty","dataProcessLoader"],"mappings":"4FAAA,4JAmBe,SAASA,IACvB,MAAM,MAAEC,EAAF,SAASC,EAAT,eAAmBC,EAAnB,EAAmCC,EAAnC,KAAsCC,GAASC,IAAMC,WAAWC,YAC/DC,EAASC,GAAcJ,IAAMK,UAAS,IAgBvC,SACLC,EADK,UAELC,EAFK,SAGLC,EAHK,aAILC,EAJK,MAKLC,EALK,OAMLC,EANK,YAOLC,GACGC,cAEJ,OACC,kBAAC,IAAD,KACC,yBAAKC,GAAG,SACP,yBAAKC,UAAU,gBACd,0BACCC,SAAUP,EA7BOQ,UACrBb,GAAW,GAEX,MAAMc,QAAaC,yBAAevB,EAAUwB,GACxCF,GACHrB,EAAeqB,GACXE,EAAKC,QAAQC,8BAAoBJ,EAAMK,aAC3CC,mBAAS,UAELlB,EAAS,gBAAiB,CAAEmB,KAAM,SAAUC,QAASC,WAAQ,eAElEvB,GAAW,KAmBPW,UAAU,0EAEV,wBAAID,GAAG,SAAP,UACA,2BACCW,KAAK,OACLG,YAAY,WACZb,UAAU,QACVD,GAAG,QACHe,KAAK,QACNC,SAAU,IAAMlB,EAAY,iBAC3BmB,IAAKvB,EAAS,CACbwB,SAAUL,WAAQ,aAIpB,kBAAC,IAAD,CACAM,GAAG,IACHlB,UAAU,UACVJ,OAAQA,EACRkB,KAAK,UAEL,kBAAC,IAAD,CACCI,GAAG,IACHlB,UAAU,UACVJ,OAAQA,EACRkB,KAAK,kBAGN,2BACCJ,KAAK,WACLG,YAAY,WACZC,KAAK,OACNC,SAAU,IAAMlB,EAAY,iBAC3BG,UAAU,QACVD,GAAG,OACHiB,IAAKvB,EAAS,CACbwB,SAAUL,WAAQ,aAIpB,kBAAC,IAAD,CACCM,GAAG,IACHlB,UAAU,UACVJ,OAAQA,EACRkB,KAAK,SAGN,yBAAKd,UAAU,mCACb,2BAAOc,KAAK,SAASE,IAAKvB,IAAYiB,KAAK,aAC5C,uBAAGX,GAAG,UAAN,eACA,kBAAC,OAAD,CAAMC,UAAU,UAAUD,GAAG,cAAcoB,GAAG,WAA9C,YAKD,4BAAQT,KAAK,SAASX,GAAG,aACvBC,UAAU,yCACVoB,SAAUhC,IAAYiC,kBAAQzB,IAC7BR,EAAUkC,oBAAoB","file":"component---src-pages-login-js-c8234cdf20d3908a033e.js","sourcesContent":["import React from \"react\"\nimport LoggedOut from \"../components/layout/loggedOut\"\nimport { Link, navigate } from \"gatsby\"\nimport { useForm } from \"react-hook-form\"\nimport { ErrorMessage } from \"@hookform/error-message\"\nimport {\n\terr_msgs,\n\tapi,\n\tdataProcessLoader,\n\tjwtSecret,\n} from \"../shared/constants.js\"\nimport {\n\tcheckLoginData,\n\tisEmpty,\n\tcacheToLocalStorage,\n} from \"../shared/utilities.js\"\nimport { Context } from \"../components/wrapper\"\n\n// prettier-ignore\nexport default function Login() {\n\tconst { token, allUsers, setCurrentUser, x, setX } = React.useContext(Context)\n\tconst [loading, setLoading] = React.useState(false)\n\n\tconst onValidSubmit = async (data) => {\n\t\tsetLoading(true)\n\n\t\tconst user = await checkLoginData(allUsers, data)\n\t\tif (user) {\n\t\t\tsetCurrentUser(user)\n\t\t\tif (data.rem_me) cacheToLocalStorage(user, jwtSecret)\n\t\t\tnavigate(\"/user\")\n\t\t}\n\t\telse setError(\"uname_or_pass\", { type: \"manual\", message: err_msgs[\"cred_invalid\"] })\n\n\t\tsetLoading(false)\n\t}\n\n\tconst {\n\t\tsetError,\n\t\tgetValues,\n\t\tregister,\n\t\thandleSubmit,\n\t\twatch,\n\t\terrors,\n\t\tclearErrors,\n\t} = useForm()\n\n\treturn (\n\t\t<LoggedOut>\n\t\t\t<div id=\"login\">\n\t\t\t\t<div className=\"card my-auto\">\n\t\t\t\t\t<form\n\t\t\t\t\t\tonSubmit={handleSubmit(onValidSubmit)}\n\t\t\t\t\t\tclassName=\"card-body d-flex align-items-center justify-content-center flex-column\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<h1 id=\"title\">Log In</h1>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tplaceholder=\"username\"\n\t\t\t\t\t\t\tclassName=\"field\"\n\t\t\t\t\t\t\tid=\"uname\"\n\t\t\t\t\t\t\tname=\"uname\"\n\t\t\t\t\t\tonChange={() => clearErrors(\"uname_or_pass\")}\n\t\t\t\t\t\t\tref={register({\n\t\t\t\t\t\t\t\trequired: err_msgs[\"required\"],\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<ErrorMessage\n\t\t\t\t\t\tas=\"p\"\n\t\t\t\t\t\tclassName=\"err_msg\"\n\t\t\t\t\t\terrors={errors}\n\t\t\t\t\t\tname=\"uname\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ErrorMessage\n\t\t\t\t\t\t\tas=\"p\"\n\t\t\t\t\t\t\tclassName=\"err_msg\"\n\t\t\t\t\t\t\terrors={errors}\n\t\t\t\t\t\t\tname=\"uname_or_pass\"\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\tplaceholder=\"password\"\n\t\t\t\t\t\t\tname=\"pass\"\n\t\t\t\t\t\tonChange={() => clearErrors(\"uname_or_pass\")}\n\t\t\t\t\t\t\tclassName=\"field\"\n\t\t\t\t\t\t\tid=\"pass\"\n\t\t\t\t\t\t\tref={register({\n\t\t\t\t\t\t\t\trequired: err_msgs[\"required\"],\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<ErrorMessage\n\t\t\t\t\t\t\tas=\"p\"\n\t\t\t\t\t\t\tclassName=\"err_msg\"\n\t\t\t\t\t\t\terrors={errors}\n\t\t\t\t\t\t\tname=\"pass\"\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<div className=\"d-flex w-100 align-items-center\">\n\t\t\t\t\t\t\t\t<input name=\"rem_me\" ref={register()} type=\"checkbox\" />\n\t\t\t\t\t\t\t<p id=\"rem-me\">Remember me</p>\n\t\t\t\t\t\t\t<Link className=\"ml-auto\" id=\"btn-sign-up\" to=\"/signup\">\n\t\t\t\t\t\t\t\tSign up\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<button type=\"submit\" id=\"btn-submit\"\n\t\t\t\t\t\t\t\tclassName=\"align-self-start mt-4 hvr-sweep-to-top\"\n\t\t\t\t\t\t\t\tdisabled={loading || !isEmpty(errors)}\n\t\t\t\t\t\t>{ loading ? dataProcessLoader : \"Submit\"}</button>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</LoggedOut>\n\t)\n}\n"],"sourceRoot":""}