(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{Wwxz:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return p}));var s=a("q1tI"),n=a.n(s),r=a("6LfT"),l=a("Wbzz"),i=a("NKCw"),m=a("8Aud"),o=a("bfiW"),c=a("Xj0o"),u=a("wStg");function d(){const e=(t=["\n\t\t\t\tmutation($uname: String!, $pass: String!) {\n\t\t\t\t\tcreateTodoer(input: { data: { uname: $uname, pass: $pass } }) {\n\t\t\t\t\t\ttodoer {\n\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\ttodos {\n\t\t\t\t\t\t\t\ttext\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t"],a||(a=t.slice(0)),t.raw=a,t);var t,a;return d=function(){return e},e}function p(){const{setError:e,getValues:t,register:s,handleSubmit:p,watch:g,errors:h,clearErrors:f}=Object(i.b)(),{allUsers:w,token:b,setCurrentUser:E,setAllUsers:_}=n.a.useContext(c.Context),[x,y]=n.a.useState(!1),[N,S]=n.a.useState(!1);return n.a.createElement(r.a,null,n.a.createElement("p",null,N&&"Something went wrong, please try again"),n.a.createElement("div",{id:"signup"},n.a.createElement("div",{className:"card my-auto"},n.a.createElement("form",{onSubmit:p(async t=>{try{y(!0),S(!1);const{GraphQLClient:s,gql:n,request:r}=await Promise.resolve().then(a.t.bind(null,"6FLb",7)),i=new s(o.api+"/graphql",{headers:{Authorization:"Bearer "+b}}),m=n(d());(await Promise.all([a.e(0),a.e(5)]).then(a.t.bind(null,"J5zx",7))).hash(t.pass,10,(a,s)=>{t.pass=s,i.request(m,t).then(async e=>{S(!1),y(!1);const t={...e.createTodoer.todoer},{todoers:a}=await Object(u.pullAllUsers)(b);_(a),E(t),Object(u.cacheToLocalStorage)(t,o.jwtSecret),Object(l.navigate)("/user")}).catch(t=>{Object(u.findVal)(t,"detail").match(/exists/g)?e("uname",{type:"manual",message:"That one exists"}):S(!0),y(!1)})})}catch(s){S(!0),y(!1)}}),className:"card-body d-flex align-items-center justify-content-center flex-column"},n.a.createElement("h1",{id:"title"},"Sign Up"),n.a.createElement("input",{type:"text",placeholder:"username",className:"field",id:"uname",ref:s({required:o.err_msgs.required,validate:e=>(e=>e.length<3||e.length>10?o.err_msgs.uname_minmax:!/[^\w-]+/g.test(e)||o.err_msgs.uname_regex)(e)}),name:"uname"}),n.a.createElement(m.a,{as:"p",className:"err_msg",errors:h,name:"uname"}),n.a.createElement("input",{type:"password",placeholder:"password",className:"field",id:"pass",ref:s({required:o.err_msgs.required,validate:{minmax:e=>(e.length<3||e.length>20)&&o.err_msgs.pass_minmax||!0}}),name:"pass"}),n.a.createElement(m.a,{as:"p",className:"err_msg",errors:h,name:"pass"}),n.a.createElement("input",{type:"password",placeholder:"confirm password",className:"field",id:"conf_pass",ref:s({required:"This field is required",validate:{nomatch:e=>e===t("pass")||o.err_msgs.pass_nomatch}}),name:"conf_pass"}),n.a.createElement(m.a,{as:"p",className:"err_msg",errors:h,name:"conf_pass"}),n.a.createElement("div",{className:"row no-gutters w-100 justify-content-between"},n.a.createElement("button",{id:"btn-submit",type:"submit",className:"align-self-start hvr-sweep-to-top",disabled:x||!Object(u.isEmpty)(h)},x?o.dataProcessLoader:"Submit"),n.a.createElement(l.Link,{to:"/login",id:"btn-login",className:"align-self-end mb-3"},"Log In"))))))}}}]);
//# sourceMappingURL=component---src-pages-signup-js-9aa0f197ad9855d784da.js.map